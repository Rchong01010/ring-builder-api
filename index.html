<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Design Your Ring</title>

  <!-- React -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Outfit', sans-serif; }
  </style>
</head>
<body>

  <div id="ring-builder-root"></div>

  <script type="text/babel" data-presets="react">
    /* =========================
       CONFIG — UPDATE THESE
    ========================== */
    const CONFIG = {
      API_BASE_URL: 'https://ring-builder-api.onrender.com/api',
      SHOPIFY_DOMAIN: 'your-store.myshopify.com',
      CUSTOM_RING_VARIANT_ID: '12345678901234',
      USE_LIVE_API: false
    };

    const { useState, useEffect, useCallback } = React;

    /* =========================
       ICONS
    ========================== */
    const Icon = ({ name, size = 24 }) => {
      const icons = {
        chevronRight: <svg width={size} height={size} viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6" fill="none" stroke="currentColor" strokeWidth="2"/></svg>,
        chevronLeft: <svg width={size} height={size} viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6" fill="none" stroke="currentColor" strokeWidth="2"/></svg>,
        check: <svg width={size} height={size} viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12" fill="none" stroke="currentColor" strokeWidth="2"/></svg>,
        ring: <svg width={size} height={size} viewBox="0 0 24 24"><circle cx="12" cy="12" r="8" fill="none" stroke="currentColor" strokeWidth="1.5"/><circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" strokeWidth="1.5"/></svg>,
        diamond: <svg width={size} height={size} viewBox="0 0 24 24"><path d="M6 3h12l4 6-10 13L2 9z" fill="none" stroke="currentColor" strokeWidth="1.5"/></svg>,
        upload: <svg width={size} height={size} viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" fill="none" stroke="currentColor"/><polyline points="17 8 12 3 7 8" fill="none" stroke="currentColor"/><line x1="12" y1="3" x2="12" y2="15" stroke="currentColor"/></svg>
      };
      return icons[name] || null;
    };

    /* =========================
       MOCK DATA (DEMO MODE)
    ========================== */
    const mockSettings = [
      {
        id: '1',
        sku: 'SOL-001',
        name: 'Classic Solitaire',
        style: 'Solitaire',
        prices: {
          WG: { label: '14K White Gold', color: 'White', price: 980 },
          YG: { label: '14K Yellow Gold', color: 'Yellow', price: 980 }
        },
        centerShapes: ['ROUND', 'OVAL'],
        shippingDays: 10,
        images: ['https://www.overnightmountings.com/media/catalog/product/8/1/81208_5.jpg']
      }
    ];

    const shapes = [
      { id: 'ROUND', name: 'Round', icon: '○' },
      { id: 'OVAL', name: 'Oval', icon: '⬭' },
      { id: 'CUSHION', name: 'Cushion', icon: '▢' }
    ];

    const ringSizes = ['4', '5', '6', '7', '8', '9'];

    /* =========================
       MAIN APP
    ========================== */
    function RingBuilder() {
      const [step, setStep] = useState(0);
      const [setting, setSetting] = useState(null);
      const [metal, setMetal] = useState(null);
      const [shape, setShape] = useState(null);
      const [size, setSize] = useState(null);

      const addToCart = async () => {
        const payload = {
          setting: setting.name,
          metal: setting.prices[metal].label,
          shape,
          size
        };

        try {
          await fetch(\`https://\${CONFIG.SHOPIFY_DOMAIN}/cart/add.js\`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              id: CONFIG.CUSTOM_RING_VARIANT_ID,
              quantity: 1,
              properties: payload
            })
          });
          window.location.href = \`https://\${CONFIG.SHOPIFY_DOMAIN}/cart\`;
        } catch {
          alert(JSON.stringify(payload, null, 2));
        }
      };

      return (
        <div style={{ padding: 40 }}>
          {step === 0 && (
            <>
              <h1>Choose Setting</h1>
              {mockSettings.map(s => (
                <button key={s.id} onClick={() => { setSetting(s); setMetal(Object.keys(s.prices)[0]); setStep(1); }}>
                  {s.name}
                </button>
              ))}
            </>
          )}

          {step === 1 && (
            <>
              <h1>Select Shape</h1>
              {shapes.map(s => (
                <button key={s.id} onClick={() => { setShape(s.id); setStep(2); }}>
                  {s.name}
                </button>
              ))}
            </>
          )}

          {step === 2 && (
            <>
              <h1>Select Size</h1>
              {ringSizes.map(s => (
                <button key={s} onClick={() => setSize(s)}>
                  {s}
                </button>
              ))}
              <br /><br />
              <button onClick={addToCart}>Request Quote</button>
            </>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('ring-builder-root')).render(<RingBuilder />);
  </script>
</body>
</html>
