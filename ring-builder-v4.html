<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ring Builder | Gabriella Amoura</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600&family=Nunito+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --bg: #FAF8F5; --bg-panel: #FFFFFF; --bg-card: #F5F2ED; --bg-card-hover: #EDE9E3;
      --text: #2C2C2C; --text-dim: #6B6B6B; --gold: #C9A962; --gold-bright: #D4B976;
      --gold-dim: #A88F4F; --gold-light: rgba(201,169,98,0.15); --radius: 12px;
    }
    @keyframes fadeIn { from{opacity:0}to{opacity:1} }
    @keyframes slideUp { from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)} }
    html, body { height: 100%; }
    body { font-family: 'Nunito Sans', sans-serif; background: var(--bg); color: var(--text); }
    #app { min-height: 100%; display: flex; flex-direction: column; }
    
    /* Header */
    .header {
      padding: 14px 24px; display: flex; justify-content: space-between; align-items: center;
      border-bottom: 1px solid rgba(201,169,98,0.15); background: var(--bg-panel);
      position: sticky; top: 0; z-index: 100;
    }
    .logo { font-family: 'Cormorant Garamond', serif; font-size: 1.25rem; letter-spacing: 2.5px; text-transform: uppercase; }
    .logo span { color: var(--gold); }
    .progress { display: flex; align-items: center; gap: 8px; }
    .progress-track { display: flex; gap: 4px; }
    .progress-segment { width: 28px; height: 3px; background: rgba(201,169,98,0.2); border-radius: 2px; transition: all 0.3s; }
    .progress-segment.active { background: var(--gold); width: 36px; }
    .progress-segment.done { background: var(--gold-dim); }
    .progress-text { font-size: 0.6rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1.5px; margin-left: 10px; }
    
    /* Main Layout */
    .main { flex: 1; display: grid; grid-template-columns: 1fr 380px; }
    
    /* Preview Area */
    .preview-area {
      display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 24px;
      background: linear-gradient(180deg, rgba(201,169,98,0.02) 0%, rgba(245,242,237,0.5) 100%);
    }
    .ring-stage {
      position: relative; width: 400px; height: 400px; display: flex; align-items: center;
      justify-content: center; cursor: grab; user-select: none;
    }
    .ring-stage:active { cursor: grabbing; }
    .ring-stage video, .ring-stage img {
      max-width: 90%; max-height: 90%; object-fit: contain; pointer-events: none;
      border-radius: 4px; animation: fadeIn 0.25s ease;
    }
    .ring-placeholder {
      width: 160px; height: 160px; border: 2px dashed rgba(201,169,98,0.35); border-radius: 50%;
      display: flex; align-items: center; justify-content: center; color: var(--text-dim);
      font-size: 0.8rem; text-align: center; padding: 20px; line-height: 1.5;
    }
    .drag-hint {
      position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
      display: flex; align-items: center; gap: 6px; font-size: 0.65rem; color: var(--text-dim);
      background: rgba(255,255,255,0.95); padding: 5px 12px; border-radius: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }
    .preview-info { margin-top: 16px; text-align: center; }
    .preview-title { font-family: 'Cormorant Garamond', serif; font-size: 1.4rem; font-weight: 500; margin-bottom: 8px; }
    .preview-tags { display: flex; gap: 6px; justify-content: center; flex-wrap: wrap; }
    .preview-tag {
      font-size: 0.65rem; color: var(--gold-dim); background: var(--bg-panel);
      padding: 4px 10px; border-radius: 12px; border: 1px solid rgba(201,169,98,0.2);
    }
    
    /* Config Panel */
    .config-panel {
      background: var(--bg-panel); border-left: 1px solid rgba(201,169,98,0.15);
      padding: 20px; overflow-y: auto; display: flex; flex-direction: column;
    }
    .step-intro { margin-bottom: 16px; animation: slideUp 0.3s ease; }
    .step-badge { display: inline-block; font-size: 0.6rem; color: var(--gold); text-transform: uppercase; letter-spacing: 2px; margin-bottom: 6px; }
    .step-title { font-family: 'Cormorant Garamond', serif; font-size: 1.5rem; font-weight: 500; margin-bottom: 4px; }
    .step-desc { font-size: 0.8rem; color: var(--text-dim); line-height: 1.5; }
    
    .section-label { font-size: 0.6rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 8px; margin-top: 14px; }
    .section-label:first-of-type { margin-top: 0; }
    
    /* Style Tabs */
    .style-tabs { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 12px; }
    .style-tab {
      padding: 6px 12px; background: var(--bg-card); border: 1px solid transparent;
      border-radius: 16px; font-size: 0.7rem; font-weight: 500; cursor: pointer;
      transition: all 0.2s; color: var(--text);
    }
    .style-tab:hover { background: var(--bg-card-hover); }
    .style-tab.active { background: var(--gold); color: white; border-color: var(--gold); }
    
    /* Settings Grid - Scrollable */
    .settings-grid {
      display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;
      margin-bottom: 12px; max-height: 240px; overflow-y: auto; padding: 2px;
    }
    .setting-card {
      background: var(--bg-card); border: 2px solid transparent; border-radius: var(--radius);
      padding: 6px; cursor: pointer; transition: all 0.2s; text-align: center; position: relative;
    }
    .setting-card:hover { background: var(--bg-card-hover); transform: translateY(-1px); }
    .setting-card.selected { border-color: var(--gold); background: var(--bg-panel); box-shadow: 0 2px 8px var(--gold-light); }
    .setting-card.selected::after {
      content: '✓'; position: absolute; top: 4px; right: 4px; width: 16px; height: 16px;
      background: var(--gold); color: white; border-radius: 50%; font-size: 8px;
      display: flex; align-items: center; justify-content: center;
    }
    .setting-thumb { width: 100%; height: 70px; object-fit: contain; border-radius: 6px; margin-bottom: 4px; background: white; }
    .setting-shape { font-size: 0.6rem; color: var(--gold-dim); text-transform: capitalize; }
    
    /* Metal Swatches */
    .metal-row { display: flex; gap: 12px; margin-bottom: 12px; }
    .metal-swatch { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 5px; cursor: pointer; transition: transform 0.2s; }
    .metal-swatch:hover { transform: scale(1.05); }
    .swatch-circle { width: 34px; height: 34px; border-radius: 50%; border: 2px solid transparent; transition: all 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.08); }
    .swatch-circle.yellow { background: linear-gradient(135deg, #f7e18c 0%, #d4af37 50%, #aa8c2c 100%); }
    .swatch-circle.white { background: linear-gradient(135deg, #fff 0%, #e8e8e8 50%, #c8c8c8 100%); }
    .swatch-circle.rose { background: linear-gradient(135deg, #f5c6c6 0%, #e5a9a9 50%, #d49292 100%); }
    .metal-swatch.selected .swatch-circle { border-color: var(--gold); box-shadow: 0 0 0 2px var(--gold-light); }
    .swatch-label { font-size: 0.6rem; color: var(--text-dim); }
    .metal-swatch.selected .swatch-label { color: var(--gold); font-weight: 600; }
    
    /* Diamond Display (Step 2 - read only) */
    .diamond-display {
      display: flex; align-items: center; gap: 10px; padding: 12px 14px;
      background: var(--bg-card); border-radius: var(--radius); margin-bottom: 12px;
    }
    .diamond-icon { width: 40px; height: 40px; }
    .diamond-icon svg { width: 100%; height: 100%; }
    .diamond-info { flex: 1; }
    .diamond-shape-name { font-size: 0.95rem; font-weight: 600; text-transform: capitalize; }
    .diamond-note { font-size: 0.65rem; color: var(--text-dim); margin-top: 2px; }
    
    /* Carat Slider */
    .carat-section { margin-bottom: 14px; }
    .carat-header { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 8px; }
    .carat-value { font-family: 'Cormorant Garamond', serif; font-size: 1.2rem; color: var(--gold); font-weight: 500; }
    .slider-container { position: relative; height: 6px; background: var(--bg-card); border-radius: 3px; margin-bottom: 6px; }
    .slider-fill { position: absolute; left: 0; top: 0; height: 100%; background: linear-gradient(90deg, var(--gold-dim), var(--gold)); border-radius: 3px; }
    .slider-container input[type="range"] { position: absolute; width: 100%; height: 100%; top: 0; left: 0; opacity: 0; cursor: pointer; margin: 0; }
    .slider-thumb { position: absolute; top: 50%; transform: translate(-50%, -50%); width: 18px; height: 18px; background: var(--bg-panel); border: 2px solid var(--gold); border-radius: 50%; box-shadow: 0 2px 6px rgba(201,169,98,0.35); pointer-events: none; }
    .slider-labels { display: flex; justify-content: space-between; font-size: 0.55rem; color: var(--text-dim); }
    
    /* Navigation */
    .nav-row { margin-top: auto; display: flex; gap: 8px; padding-top: 14px; }
    .nav-btn {
      flex: 1; padding: 12px; border-radius: 10px; font-family: 'Nunito Sans', sans-serif;
      font-size: 0.75rem; font-weight: 600; cursor: pointer; transition: all 0.2s;
      text-transform: uppercase; letter-spacing: 1.2px;
    }
    .nav-btn.back { background: var(--bg-card); border: 1px solid rgba(201,169,98,0.25); color: var(--text); }
    .nav-btn.back:hover { background: var(--bg-card-hover); border-color: var(--gold); }
    .nav-btn.next { background: var(--gold); border: none; color: white; }
    .nav-btn.next:hover:not(:disabled) { background: var(--gold-bright); transform: translateY(-1px); box-shadow: 0 4px 15px rgba(201,169,98,0.3); }
    .nav-btn:disabled { opacity: 0.4; cursor: not-allowed; }
    
    /* Summary & Form */
    .summary-card { background: var(--bg-card); border-radius: var(--radius); overflow: hidden; margin-bottom: 14px; border: 1px solid rgba(201,169,98,0.12); }
    .summary-row { display: flex; justify-content: space-between; padding: 10px 14px; border-bottom: 1px solid rgba(201,169,98,0.08); }
    .summary-row:last-child { border-bottom: none; }
    .summary-label { color: var(--text-dim); font-size: 0.75rem; }
    .summary-value { font-weight: 600; font-size: 0.8rem; text-transform: capitalize; }
    
    .lead-form { display: flex; flex-direction: column; gap: 10px; }
    .form-field { display: flex; flex-direction: column; gap: 3px; }
    .form-label { font-size: 0.6rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.5px; }
    .form-input, .form-textarea {
      background: var(--bg-card); border: 1px solid rgba(201,169,98,0.18); border-radius: 8px;
      padding: 9px 11px; font-family: 'Nunito Sans', sans-serif; font-size: 0.8rem; color: var(--text);
    }
    .form-input:focus, .form-textarea:focus { outline: none; border-color: var(--gold); box-shadow: 0 0 0 2px var(--gold-light); }
    .form-textarea { resize: vertical; min-height: 55px; }
    .submit-btn {
      width: 100%; padding: 12px; background: var(--gold); border: none; border-radius: 10px;
      color: white; font-family: 'Nunito Sans', sans-serif; font-size: 0.75rem; font-weight: 600;
      cursor: pointer; text-transform: uppercase; letter-spacing: 1.2px; margin-top: 3px;
    }
    .submit-btn:hover:not(:disabled) { background: var(--gold-bright); transform: translateY(-1px); }
    .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .reset-btn {
      width: 100%; padding: 9px; background: transparent; border: 1px solid rgba(201,169,98,0.25);
      border-radius: 8px; color: var(--text-dim); font-family: 'Nunito Sans', sans-serif;
      font-size: 0.7rem; cursor: pointer; margin-top: 4px;
    }
    .reset-btn:hover { border-color: var(--gold); color: var(--gold); }
    
    .success-box { text-align: center; padding: 20px 0; animation: slideUp 0.3s ease; }
    .success-icon { width: 50px; height: 50px; background: linear-gradient(135deg, var(--gold), var(--gold-dim)); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 14px; font-size: 22px; color: white; }
    .success-title { font-family: 'Cormorant Garamond', serif; font-size: 1.3rem; margin-bottom: 6px; }
    .success-text { font-size: 0.75rem; color: var(--text-dim); line-height: 1.5; margin-bottom: 16px; }
    
    @media (max-width: 900px) {
      .main { grid-template-columns: 1fr; }
      .preview-area { min-height: 40vh; padding: 16px; }
      .ring-stage { width: 280px; height: 280px; }
      .config-panel { border-left: none; border-top: 1px solid rgba(201,169,98,0.15); }
    }
  </style>
</head>
<body>
  <div id="app"></div>
  <script>
    // ========== RING DATA ==========
    // Each setting has: unset images (no stone), set video (with stone spinning)
    const RING_DATA = {
      "solitaire": [
        {id:"85327", name:"Classic Round", shape:"round", 
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85327/85327.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85327/85327.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85327/85327.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85327/85327.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85327/85327.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85327/85327.video.rose.mp4"}},
        {id:"50384-E", name:"Cathedral Round", shape:"round",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50384-E/50384-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50384-E/50384-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50384-E/50384-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50384-E/50384-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50384-E/50384-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50384-E/50384-E.video.rose.mp4"}},
        {id:"51146-E", name:"Twisted Oval", shape:"oval",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51146-E/51146-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51146-E/51146-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51146-E/51146-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51146-E/51146-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51146-E/51146-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51146-E/51146-E.video.rose.mp4"}},
        {id:"51143-E", name:"Twisted Emerald", shape:"emerald",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51143-E/51143-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51143-E/51143-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51143-E/51143-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51143-E/51143-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51143-E/51143-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51143-E/51143-E.video.rose.mp4"}},
        {id:"51268-E", name:"Pear Solitaire", shape:"pear",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51268-E/51268-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51268-E/51268-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51268-E/51268-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51268-E/51268-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51268-E/51268-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51268-E/51268-E.video.rose.mp4"}},
        {id:"85433", name:"Marquise Solitaire", shape:"marquise",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85433/85433.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85433/85433.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85433/85433.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85433/85433.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85433/85433.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85433/85433.video.rose.mp4"}},
        {id:"83878", name:"Cushion Solitaire", shape:"cushion",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/83878/83878.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/83878/83878.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/83878/83878.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/83878/83878.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/83878/83878.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/83878/83878.video.rose.mp4"}},
        {id:"85438", name:"Princess Solitaire", shape:"princess",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85438/85438.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85438/85438.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85438/85438.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85438/85438.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85438/85438.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85438/85438.video.rose.mp4"}}
      ],
      "halo": [
        {id:"50903-E", name:"Classic Halo", shape:"round",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50903-E/50903-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50903-E/50903-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50903-E/50903-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50903-E/50903-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50903-E/50903-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50903-E/50903-E.video.rose.mp4"}},
        {id:"84672", name:"Antique Halo", shape:"round",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84672/84672.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84672/84672.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84672/84672.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84672/84672.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84672/84672.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84672/84672.video.rose.mp4"}},
        {id:"50816-E", name:"Oval Halo", shape:"oval",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50816-E/50816-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50816-E/50816-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50816-E/50816-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50816-E/50816-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50816-E/50816-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50816-E/50816-E.video.rose.mp4"}},
        {id:"50920-E", name:"Emerald Halo", shape:"emerald",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50920-E/50920-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50920-E/50920-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50920-E/50920-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50920-E/50920-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50920-E/50920-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50920-E/50920-E.video.rose.mp4"}},
        {id:"50950-E", name:"Pear Halo", shape:"pear",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50950-E/50950-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50950-E/50950-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50950-E/50950-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50950-E/50950-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50950-E/50950-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50950-E/50950-E.video.rose.mp4"}},
        {id:"50778-E", name:"Cushion Halo", shape:"cushion",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50778-E/50778-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50778-E/50778-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50778-E/50778-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50778-E/50778-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50778-E/50778-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50778-E/50778-E.video.rose.mp4"}}
      ],
      "hidden-halo": [
        {id:"50975-E", name:"Round Hidden Halo", shape:"round",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50975-E/50975-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50975-E/50975-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50975-E/50975-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50975-E/50975-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50975-E/50975-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50975-E/50975-E.video.rose.mp4"}},
        {id:"51141-E", name:"Oval Hidden Halo", shape:"oval",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51141-E/51141-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51141-E/51141-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51141-E/51141-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51141-E/51141-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51141-E/51141-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51141-E/51141-E.video.rose.mp4"}},
        {id:"51330-E", name:"Emerald Hidden Halo", shape:"emerald",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51330-E/51330-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51330-E/51330-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51330-E/51330-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51330-E/51330-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51330-E/51330-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51330-E/51330-E.video.rose.mp4"}},
        {id:"51336-E", name:"Pear Hidden Halo", shape:"pear",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51336-E/51336-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51336-E/51336-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51336-E/51336-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51336-E/51336-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51336-E/51336-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51336-E/51336-E.video.rose.mp4"}},
        {id:"51342-E", name:"Princess Hidden Halo", shape:"princess",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51342-E/51342-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51342-E/51342-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51342-E/51342-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51342-E/51342-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51342-E/51342-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51342-E/51342-E.video.rose.mp4"}}
      ],
      "three-stone": [
        {id:"84708", name:"Classic 3 Stone", shape:"round",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84708/84708.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84708/84708.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84708/84708.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84708/84708.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84708/84708.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84708/84708.video.rose.mp4"}},
        {id:"81795", name:"Oval 3 Stone", shape:"oval",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/81795/81795.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/81795/81795.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/81795/81795.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/81795/81795.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/81795/81795.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/81795/81795.video.rose.mp4"}},
        {id:"81986", name:"Emerald 3 Stone", shape:"emerald",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/81986/81986.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/81986/81986.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/81986/81986.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/81986/81986.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/81986/81986.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/81986/81986.video.rose.mp4"}},
        {id:"85337", name:"Pear 3 Stone", shape:"pear",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85337/85337.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85337/85337.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85337/85337.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85337/85337.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85337/85337.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/85337/85337.video.rose.mp4"}},
        {id:"83266", name:"Marquise 3 Stone", shape:"marquise",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/83266/83266.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/83266/83266.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/83266/83266.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/83266/83266.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/83266/83266.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/83266/83266.video.rose.mp4"}}
      ],
      "pave": [
        {id:"50271-E", name:"Classic Pavé", shape:"round",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50271-E/50271-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50271-E/50271-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50271-E/50271-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50271-E/50271-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50271-E/50271-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50271-E/50271-E.video.rose.mp4"}},
        {id:"51011-E", name:"Oval Pavé", shape:"oval",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51011-E/51011-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51011-E/51011-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51011-E/51011-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51011-E/51011-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51011-E/51011-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51011-E/51011-E.video.rose.mp4"}},
        {id:"51012-E", name:"Emerald Pavé", shape:"emerald",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51012-E/51012-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51012-E/51012-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51012-E/51012-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51012-E/51012-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51012-E/51012-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51012-E/51012-E.video.rose.mp4"}},
        {id:"50358-E", name:"Cushion Pavé", shape:"cushion",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50358-E/50358-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50358-E/50358-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50358-E/50358-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50358-E/50358-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50358-E/50358-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/50358-E/50358-E.video.rose.mp4"}},
        {id:"51015-E", name:"Marquise Pavé", shape:"marquise",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51015-E/51015-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51015-E/51015-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51015-E/51015-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51015-E/51015-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51015-E/51015-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51015-E/51015-E.video.rose.mp4"}}
      ],
      "vintage": [
        {id:"51071-E", name:"Vintage Round", shape:"round",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51071-E/51071-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51071-E/51071-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51071-E/51071-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51071-E/51071-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51071-E/51071-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51071-E/51071-E.video.rose.mp4"}},
        {id:"82906", name:"Vintage Oval", shape:"oval",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/82906/82906.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/82906/82906.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/82906/82906.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/82906/82906.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/82906/82906.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/82906/82906.video.rose.mp4"}},
        {id:"82904", name:"Vintage Emerald", shape:"emerald",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/82904/82904.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/82904/82904.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/82904/82904.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/82904/82904.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/82904/82904.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/82904/82904.video.rose.mp4"}},
        {id:"84009", name:"Vintage Marquise", shape:"marquise",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84009/84009.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84009/84009.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84009/84009.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84009/84009.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84009/84009.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/84009/84009.video.rose.mp4"}},
        {id:"51024-E", name:"Vintage Cushion", shape:"cushion",
          unset:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51024-E/51024-E.jpg",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51024-E/51024-E.alt.jpg",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51024-E/51024-E.alt1.jpg"},
          video:{white:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51024-E/51024-E.video.white.mp4",yellow:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51024-E/51024-E.video.yellow.mp4",rose:"https://connect.overnightmountings.com/gemfind/library/Images_And_Videos/51024-E/51024-E.video.rose.mp4"}}
      ]
    };
    
    const STYLES = [{id:'solitaire',name:'Solitaire'},{id:'halo',name:'Halo'},{id:'hidden-halo',name:'Hidden Halo'},{id:'three-stone',name:'Three Stone'},{id:'pave',name:'Pavé'},{id:'vintage',name:'Vintage'}];
    const METALS = [{id:'white',name:'White Gold'},{id:'yellow',name:'Yellow Gold'},{id:'rose',name:'Rose Gold'}];
    const CARATS = ['0.5','0.75','1.0','1.25','1.5','1.75','2.0','2.5','3.0','3.5','4.0','4.5','5.0'];
    
    const diamondSVGs = {
      round: '<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="17" fill="none" stroke="currentColor" stroke-width="2"/></svg>',
      oval: '<svg viewBox="0 0 50 50"><ellipse cx="25" cy="25" rx="17" ry="11" fill="none" stroke="currentColor" stroke-width="2"/></svg>',
      emerald: '<svg viewBox="0 0 50 50"><rect x="9" y="15" width="32" height="20" fill="none" stroke="currentColor" stroke-width="2"/></svg>',
      pear: '<svg viewBox="0 0 50 50"><path d="M25 8 Q40 24 30 36 Q26 42 25 42 Q24 42 20 36 Q10 24 25 8" fill="none" stroke="currentColor" stroke-width="2"/></svg>',
      marquise: '<svg viewBox="0 0 50 50"><ellipse cx="25" cy="25" rx="9" ry="18" fill="none" stroke="currentColor" stroke-width="2"/></svg>',
      princess: '<svg viewBox="0 0 50 50"><rect x="11" y="11" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2"/></svg>',
      cushion: '<svg viewBox="0 0 50 50"><rect x="11" y="11" width="28" height="28" rx="5" fill="none" stroke="currentColor" stroke-width="2"/></svg>'
    };
    
    // ========== STATE ==========
    let state = { step:1, styleTab:'solitaire', setting:null, metal:'white', carat:'1.5', formStatus:'idle' };
    let videoEl = null, isDragging = false, startX = 0, startTime = 0;
    
    function onDragStart(e) { if(!videoEl||videoEl.readyState<2)return; isDragging=true; startX=e.touches?e.touches[0].clientX:e.clientX; startTime=videoEl.currentTime; e.preventDefault(); }
    function onDragMove(e) { if(!isDragging||!videoEl)return; const x=e.touches?e.touches[0].clientX:e.clientX; let t=startTime+(x-startX)*0.008; const d=videoEl.duration||5; while(t<0)t+=d; while(t>d)t-=d; videoEl.currentTime=Math.max(0,Math.min(d-0.01,t)); }
    function onDragEnd() { isDragging=false; }
    
    // ========== RENDER ==========
    function render() {
      const app = document.getElementById('app');
      const stepNames = ['Setting','Diamond','Submit'];
      const settings = RING_DATA[state.styleTab] || [];
      const s = state.setting;
      const metalName = METALS.find(m=>m.id===state.metal)?.name||'';
      const styleName = STYLES.find(st=>st.id===state.styleTab)?.name||'';
      
      let preview = '', title = 'Your Ring';
      
      if (state.step === 1) {
        // Step 1: Show UNSET image (no stone)
        if (s) {
          preview = `<img src="${s.unset[state.metal]}" alt="${s.name}" id="ringImg">`;
          title = s.name;
        } else {
          preview = '<div class="ring-placeholder">Select a setting to preview</div>';
        }
      } else if (state.step >= 2 && s) {
        // Step 2+: Show VIDEO with stone
        preview = `
          <video id="ringVideo" muted playsinline preload="auto">
            <source src="${s.video[state.metal]}" type="video/mp4">
          </video>
          <div class="drag-hint">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 8l4 4-4 4M10 16l-4-4 4-4"/></svg>
            Drag to spin
          </div>`;
        title = `${s.shape.charAt(0).toUpperCase()+s.shape.slice(1)} ${styleName}`;
      }
      
      app.innerHTML = `
        <header class="header">
          <div class="logo">Gabriella <span>Amoura</span></div>
          <div class="progress">
            <div class="progress-track">${[1,2,3].map(n=>`<div class="progress-segment ${n===state.step?'active':''} ${n<state.step?'done':''}"></div>`).join('')}</div>
            <span class="progress-text">${stepNames[state.step-1]}</span>
          </div>
        </header>
        <main class="main">
          <div class="preview-area">
            <div class="ring-stage" id="ringStage">${preview}</div>
            <div class="preview-info">
              <h2 class="preview-title">${title}</h2>
              <div class="preview-tags">
                <span class="preview-tag">${metalName}</span>
                ${state.step>=2&&s?`<span class="preview-tag">${state.carat} ct</span><span class="preview-tag">${s.shape}</span>`:''}
              </div>
            </div>
          </div>
          <div class="config-panel">${renderStep(settings)}${renderNav()}</div>
        </main>`;
      
      addListeners(settings);
      
      // Setup video drag
      if (state.step >= 2) {
        setTimeout(() => {
          const v = document.getElementById('ringVideo');
          if (v) {
            v.onloadeddata = () => { videoEl = v; v.pause(); v.currentTime = 0; };
            if (v.readyState >= 2) { videoEl = v; v.pause(); }
            const stage = document.getElementById('ringStage');
            stage.onmousedown = onDragStart;
            stage.ontouchstart = onDragStart;
            document.onmousemove = onDragMove;
            document.ontouchmove = onDragMove;
            document.onmouseup = onDragEnd;
            document.ontouchend = onDragEnd;
          }
        }, 50);
      }
    }
    
    function renderStep(settings) {
      if (state.step === 1) {
        return `
          <div class="step-intro">
            <span class="step-badge">Step 1 of 3</span>
            <h2 class="step-title">Choose Your Setting</h2>
            <p class="step-desc">Select a style category and pick a ring setting.</p>
          </div>
          <div class="section-label">Style</div>
          <div class="style-tabs">${STYLES.map(st=>`<div class="style-tab ${state.styleTab===st.id?'active':''}" data-style="${st.id}">${st.name}</div>`).join('')}</div>
          <div class="section-label">Settings (${settings.length})</div>
          <div class="settings-grid">${settings.map((r,i)=>`
            <div class="setting-card ${state.setting?.id===r.id?'selected':''}" data-idx="${i}">
              <img src="${r.unset[state.metal]}" class="setting-thumb" alt="${r.name}">
              <div class="setting-shape">${r.shape}</div>
            </div>`).join('')}
          </div>
          <div class="section-label">Metal</div>
          <div class="metal-row">${METALS.map(m=>`
            <div class="metal-swatch ${state.metal===m.id?'selected':''}" data-metal="${m.id}">
              <div class="swatch-circle ${m.id}"></div>
              <span class="swatch-label">${m.name}</span>
            </div>`).join('')}
          </div>`;
      }
      
      if (state.step === 2) {
        const s = state.setting;
        const ci = CARATS.indexOf(state.carat), cp = (ci/(CARATS.length-1))*100;
        return `
          <div class="step-intro">
            <span class="step-badge">Step 2 of 3</span>
            <h2 class="step-title">Customize Diamond</h2>
            <p class="step-desc">Review diamond shape and select carat size.</p>
          </div>
          <div class="section-label">Diamond Shape</div>
          <div class="diamond-display">
            <div class="diamond-icon" style="color:var(--gold)">${diamondSVGs[s?.shape]||diamondSVGs.round}</div>
            <div class="diamond-info">
              <div class="diamond-shape-name">${s?.shape||''}</div>
              <div class="diamond-note">Determined by your setting selection</div>
            </div>
          </div>
          <div class="section-label">Carat Size</div>
          <div class="carat-section">
            <div class="carat-header"><span></span><span class="carat-value">${state.carat} ct</span></div>
            <div class="slider-container">
              <div class="slider-fill" style="width:${cp}%"></div>
              <div class="slider-thumb" style="left:${cp}%"></div>
              <input type="range" id="caratSlider" min="0" max="${CARATS.length-1}" value="${ci}">
            </div>
            <div class="slider-labels"><span>0.5 ct</span><span>2.5 ct</span><span>5.0 ct</span></div>
          </div>
          <div class="section-label">Metal</div>
          <div class="metal-row">${METALS.map(m=>`
            <div class="metal-swatch ${state.metal===m.id?'selected':''}" data-metal="${m.id}">
              <div class="swatch-circle ${m.id}"></div>
              <span class="swatch-label">${m.name}</span>
            </div>`).join('')}
          </div>`;
      }
      
      if (state.step === 3) {
        if (state.formStatus === 'success') {
          return `<div class="success-box"><div class="success-icon">✓</div><h3 class="success-title">Inquiry Sent!</h3><p class="success-text">We'll reach out within 24 hours with options tailored for you.</p><button class="reset-btn" id="resetBtn">Design Another Ring</button></div>`;
        }
        const s = state.setting;
        const styleName = STYLES.find(st=>st.id===state.styleTab)?.name||'';
        return `
          <div class="step-intro">
            <span class="step-badge">Final Step</span>
            <h2 class="step-title">Your Dream Ring</h2>
            <p class="step-desc">Review your design and submit inquiry.</p>
          </div>
          <div class="summary-card">
            <div class="summary-row"><span class="summary-label">Style</span><span class="summary-value">${styleName}</span></div>
            <div class="summary-row"><span class="summary-label">Setting</span><span class="summary-value">${s?.name||''}</span></div>
            <div class="summary-row"><span class="summary-label">Diamond</span><span class="summary-value">${s?.shape||''}</span></div>
            <div class="summary-row"><span class="summary-label">Carat</span><span class="summary-value">${state.carat} ct</span></div>
            <div class="summary-row"><span class="summary-label">Metal</span><span class="summary-value">${METALS.find(m=>m.id===state.metal)?.name||''}</span></div>
          </div>
          <form class="lead-form" id="leadForm">
            <div class="form-field"><label class="form-label">Name *</label><input class="form-input" name="name" required placeholder="Your name"></div>
            <div class="form-field"><label class="form-label">Email *</label><input class="form-input" name="email" type="email" required placeholder="you@email.com"></div>
            <div class="form-field"><label class="form-label">Phone</label><input class="form-input" name="phone" type="tel" placeholder="(555) 123-4567"></div>
            <div class="form-field"><label class="form-label">Details</label><textarea class="form-textarea" name="message" placeholder="Budget, timeline, special requests..."></textarea></div>
            <button type="submit" class="submit-btn" ${state.formStatus==='submitting'?'disabled':''}>${state.formStatus==='submitting'?'Sending...':'Submit Inquiry'}</button>
            <button type="button" class="reset-btn" id="startOverBtn">Start Over</button>
          </form>`;
      }
      return '';
    }
    
    function renderNav() {
      if (state.step === 3) return '';
      const canProceed = state.step === 1 ? state.setting !== null : true;
      return `<div class="nav-row">${state.step>1?'<button class="nav-btn back" id="backBtn">Back</button>':''}<button class="nav-btn next" id="nextBtn" ${!canProceed?'disabled':''}>${state.step===2?'Review Ring':'Continue'}</button></div>`;
    }
    
    function addListeners(settings) {
      document.querySelectorAll('.style-tab').forEach(t => t.onclick = () => { state.styleTab = t.dataset.style; state.setting = null; render(); });
      document.querySelectorAll('.setting-card').forEach(c => c.onclick = () => { state.setting = settings[+c.dataset.idx]; render(); });
      document.querySelectorAll('.metal-swatch').forEach(s => s.onclick = () => { state.metal = s.dataset.metal; render(); });
      const sl = document.getElementById('caratSlider'); if(sl) sl.oninput = e => { state.carat = CARATS[e.target.value]; render(); };
      const nb = document.getElementById('nextBtn'); if(nb) nb.onclick = () => { state.step++; render(); };
      const bb = document.getElementById('backBtn'); if(bb) bb.onclick = () => { state.step--; render(); };
      const f = document.getElementById('leadForm'); if(f) f.onsubmit = e => { e.preventDefault(); state.formStatus='submitting'; render(); setTimeout(()=>{state.formStatus='success';render();},1500); };
      ['resetBtn','startOverBtn'].forEach(id => { const b = document.getElementById(id); if(b) b.onclick = () => { state = {step:1, styleTab:'solitaire', setting:null, metal:'white', carat:'1.5', formStatus:'idle'}; render(); }; });
    }
    
    render();
  </script>
</body>
</html>
